\chapter{Getting Started}
\hypertarget{md__getting_01_started}{}\label{md__getting_01_started}\index{Getting Started@{Getting Started}}
\hypertarget{md__getting_01_started_autotoc_md0}{}\doxysection{\texorpdfstring{Getting Started with Cygnus Reach}{Getting Started with Cygnus Reach}}\label{md__getting_01_started_autotoc_md0}
I3 Product Design

Version 1.\+01

Date January 16, 2024\hypertarget{md__getting_01_started_autotoc_md1}{}\doxysubsection{\texorpdfstring{autotoc\+\_\+md1}{autotoc\+\_\+md1}}\label{md__getting_01_started_autotoc_md1}
\hypertarget{md__getting_01_started_autotoc_md2}{}\doxysection{\texorpdfstring{Executive Summary}{Executive Summary}}\label{md__getting_01_started_autotoc_md2}
Cygnus Reach is a system to provide customer support to users of embedded IoT (Internet of Things) devices. This support is also very useful to developers of such systems. ~\newline


In case you aren’t familiar with Cygnus Reach, here are two links with some overview. ~\newline



\begin{DoxyItemize}
\item \href{https://cygnustechnology.com/}{\texttt{ https\+://cygnustechnology.\+com/}}
\item \href{https://cygnustechnology.com/see-reach-in-action/}{\texttt{ https\+://cygnustechnology.\+com/see-\/reach-\/in-\/action/}}
\end{DoxyItemize}

This package provides code to exercise the Cygnus Reach system using the “\+Thunderboard”, which is a common IoT development board. This allows a user to evaluate the mobile apps and the web interface that are involved. This document briefly describes how to run the prebuilt demo and then how to rebuild the demo to make a more detailed evaluation. ~\newline


The SDK’s necessary to develop customized mobile app and web pages for Reach access are available through your Cygnus sales representative. While the demo works with the Silicon Labs hardware, the system is deployed on other platforms.\hypertarget{md__getting_01_started_autotoc_md3}{}\doxysubsection{\texorpdfstring{Audience}{Audience}}\label{md__getting_01_started_autotoc_md3}
The Cygnus Reach Evaluation Kit for the Silicon Labs Thunderboard assumes that the user is familiar with the development of IoT devices using “\+Simplicity Studio”, the Silicon Labs development system. The Silicon Labs web site contains quite a bit of introductory material which is beyond the scope of this document. A wider audience will be interested in the demo when the device is programmed.\hypertarget{md__getting_01_started_autotoc_md4}{}\doxysection{\texorpdfstring{autotoc\+\_\+md4}{autotoc\+\_\+md4}}\label{md__getting_01_started_autotoc_md4}
\hypertarget{md__getting_01_started_autotoc_md5}{}\doxysection{\texorpdfstring{Running the Demo}{Running the Demo}}\label{md__getting_01_started_autotoc_md5}
The demo requires a Reach enabled IoT device. The Thunderboard fills this role conveniently.\hypertarget{md__getting_01_started_autotoc_md6}{}\doxysubsection{\texorpdfstring{Preparation}{Preparation}}\label{md__getting_01_started_autotoc_md6}

\begin{DoxyItemize}
\item Obtain the Cygnus Reach firmware package from this site on github\+:
\begin{DoxyItemize}
\item \href{https://github.com/cygnus-technology/reach-firmware}{\texttt{ https\+://github.\+com/cygnus-\/technology/reach-\/firmware}}
\end{DoxyItemize}
\item Procure a Silicon Labs Thunderboard (SLTB010A). A quick google finds these common at Digikey and Mouser. The cost is around \$42.
\item If you are going to rebuild the Thunderboard program, install Simplicity Studio from Silicon Labs. \begin{DoxyVerb}  [https://www.silabs.com/developers/simplicity-studio](https://www.silabs.com/developers/simplicity-studio)
\end{DoxyVerb}

\begin{DoxyItemize}
\item The code is updated to match version 5.\+8 with Gecko 4.\+4.
\item For any Linux users, be aware that the default installation can go a lot faster if you set the make to use multiple threads.
\end{DoxyItemize}
\item If you are only going to flash the prebuilt binary, you can more quickly install only the Simplicity Commander tool. Google “\href{https://community.silabs.com/s/article/simplicity-commander?language=en_US}{\texttt{ download Simplicity Commande}}r” and choose the version you like. They offer Windows, Mac and Linux.
\item Install the Cygnus Reach application on your mobile device. You can find an appropriate version in the Google Play Store and in Apple’s App Store.
\begin{DoxyItemize}
\item i\+OS\+:
\begin{DoxyItemize}
\item \href{https://apps.apple.com/us/app/reach-bluetooth-analyzer/id1500040087}{\texttt{ https\+://apps.\+apple.\+com/us/app/reach-\/bluetooth-\/analyzer/id1500040087}}
\end{DoxyItemize}
\item Android
\begin{DoxyItemize}
\item \href{https://play.google.com/store/apps/details?id=com.reach_android&pli=1}{\texttt{ https\+://play.\+google.\+com/store/apps/details?id=com.\+reach\+\_\+android\&pli=1}}
\end{DoxyItemize}
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md__getting_01_started_autotoc_md7}{}\doxysubsection{\texorpdfstring{Programming the Device}{Programming the Device}}\label{md__getting_01_started_autotoc_md7}

\begin{DoxyItemize}
\item Connect your PC to the USB port on the Thunderboard. ~\newline

\item Launch Simplicity Commander.
\end{DoxyItemize}




\begin{DoxyItemize}
\item Choose the kit in the upper left. ~\newline

\item Select “prebuilt/reacher-\/tboard-\/v320.hex” (or the latest) for flashing. This includes both the bootloader and the application. Separate bootloader and app hex files are also available.
\item Poke the “\+Flash” button. The program will boot when the download is complete.
\item Connect a serial terminal to the “\+JLink CDC UART Port” exposed by the Thunderboard. It runs at the typical 115200,N,8,1. ~\newline

\item When the board is running it should respond to a carriage return with a prompt and the “ver” command should print a banner. The help command prints help.
\item You should start to see a console like shown here.  
\end{DoxyItemize}\hypertarget{md__getting_01_started_autotoc_md8}{}\doxysubsection{\texorpdfstring{autotoc\+\_\+md8}{autotoc\+\_\+md8}}\label{md__getting_01_started_autotoc_md8}
Connecting with the Cygnus App


\begin{DoxyItemize}
\item Open the Cygnus app on your phone and select this device. You can see that it has the Cygnus logo. The app can also view the characteristics on other BLE devices.
\item You can pull down the name tab to see the complete device info.
\item Poke the Device Parameters button. This will bring up the basic parameter inspection frame. ~\newline

\begin{DoxyItemize}
\item You can edit parameters here. ~\newline

\item Note the different types of supported parameters.
\item Parameter ID 13 turns the yellow LED on and off.
\begin{DoxyItemize}
\item The blue LED monitors USB activity.
\end{DoxyItemize}
\item Parameter ID 23 is increasing. Refresh to see that.
\end{DoxyItemize}

Reach provides for a remote command line interface (CLI). The Thunderboard provides a CLI on the USB based serial port. Reach also supports a remote CLI using the app. This can be very helpful in development and troubleshooting. 

Commands provide a simple way to execute a function on the device. The command tab has several useful functions.
\item You can enable and disable the remote command line interface.
\item You can adjust the amount of serial port logging.

Reach supports high speed data transfer as “files”. ~\newline

\end{DoxyItemize}

   \hypertarget{md__getting_01_started_autotoc_md9}{}\doxysubsection{\texorpdfstring{File Access and the Debug Interface}{File Access and the Debug Interface}}\label{md__getting_01_started_autotoc_md9}
The file access features of Cygnus support the efficient transfer of larger blocks of data. The “simple” interface interacts with files on your phone and gives you the option of emailing received files. The debug interface gives you more control. Access the debug interface from the three dots in the upper right corner.  Here a button represents each of the basic message commands in the Reach protocol. The phone issues the request and the resulting action is printed on the screen. The response is shown in hex. The message is decoded into a JSON like format. The hex bytes that were sent are not displayed here. They are visible on the serial console of the device.  You can exercise finer control over the file operations on the debug screen. First minimize logging using command 3. Then select a fairly large size to read. These tests send synthetic data, just increasing numbers to exercise the transfer rate. You can experiment with the Acknowledgement rate and easily achieve transfer rates over 200kbps.\hypertarget{md__getting_01_started_autotoc_md10}{}\doxysubsection{\texorpdfstring{The Serial Console}{The Serial Console}}\label{md__getting_01_started_autotoc_md10}
By default you see messages on the serial console as illustrated below.


\begin{DoxyItemize}
\item A banner is printed at startup.
\item The yellow text about the PHY indicates we are connected to the phone.
\item The magenta text indicates we have received a new prompt from the phone. The hex bytes are printed. This is the “wire” log.
\item The cyan text prints what is decoded or to be encoded. This is the “reach” log. In this illustration the request for device info is answered.
\item Finally, the command “lm ?” shows you the bit field values of the log mask. You can enable or disable various bits of logging.  The command pane allows you to enable the remote CLI.
\end{DoxyItemize}

The remote command line interface (CLI) is disabled by default. When enabled, the command line of the device is accessible on the phone.

Rather verbose logging is enabled on the device by default. Commands are provided to minimize and maximize the logging. More finely grained control of the logging is provided through the CLI.

You can experiment with the file transfers. When all logging is disabled (command “lm 0” on the device console) and the “ack rate” is set relatively high (say 100), a file read transfer rate over 300kbps is easily achieved. Write transfer rates are over 100kbps.\hypertarget{md__getting_01_started_autotoc_md11}{}\doxysubsection{\texorpdfstring{The Web Interface}{The Web Interface}}\label{md__getting_01_started_autotoc_md11}
The remote access capability of Cygnus relies on a mobile device (a phone) which is near the IoT device to act as a relay to a support engineer located remotely. The end user who needs help can connect to the device with their phone and then connect to a support engineer who has visibility into the device. You can demonstrate this using this kit. ~\newline



\begin{DoxyEnumerate}
\item Complete the demo of the Cygnus app to verify the device.
\item Go to \href{https://cygnustechnology.com/}{\texttt{ https\+://cygnustechnology.\+com/}}. You will need to create an account. This account allows you to evaluate the system. It’s immediately granted. It doesn’t confer enough rights to support the deployment of a real product. Full product support requires a licensing agreement that is available from your Cygnus sales representative.
\item Having created an account you are invited to start a support session. It may take a few minutes for the account to become active to access this page. Enter an arbitrary name for the session. This allows the session to be recorded for later reference.
\end{DoxyEnumerate}

 Clicking on “\+Start Support Session” brings you to a PIN page. 

Open the app on your phone and select “\+Start Remote Support Session” at the bottom of the page. Enter the PIN. Accept the permission request to start “recording or casting with Cygnus Reach”.

Select “\+Device Info” on the web page. You see what is essentially the same interface as you see on the phone.



You can initiate a video sharing session which will allow the support engineer to see what is happening in the device.



You can also see the phone’s screen and chat with the user.\hypertarget{md__getting_01_started_autotoc_md12}{}\doxysection{\texorpdfstring{Building the Demo}{Building the Demo}}\label{md__getting_01_started_autotoc_md12}
You can rebuild the application and modify it to your needs. The process is described here. It assumes that you have already run the demo on a Thunderboard.\hypertarget{md__getting_01_started_autotoc_md13}{}\doxysubsection{\texorpdfstring{Create a new Project}{Create a new Project}}\label{md__getting_01_started_autotoc_md13}
Use the New menu entry to access the “\+Silicon Labs New Project Wizard”. 

Choose the Thunderboard EFR32\+BG22 (BRD4184A) using the EFR32\+BG22\+C224\+F512\+IM40. If your thunderboard is attached to the USB port these should be selected automatically. You want the latest Gecko SDK, here 4.\+4.\+0, and the GCC compiler, here “\+Simplicity IDE / GNU ARM v12.\+2.\+1”

Click on “\+Next”.  Select the “\+Bluetooth SoC Empty” project. This will work best to duplicate the demo. Other starting points might be more appropriate for a larger project. For instance, SoC Empty has no RTOS.

Click on Next.  {\bfseries{Important! Rename the project to “reach\+\_\+tboard”.}}

You can accept the default location or choose your own location. ~\newline


Choose “\+Link SDK and copy project sources”.

More advanced users of Simplicity Studio might change these settings. They may have an impact on various configuration files.\hypertarget{md__getting_01_started_autotoc_md14}{}\doxysubsection{\texorpdfstring{Copy in the Reach Source}{Copy in the Reach Source}}\label{md__getting_01_started_autotoc_md14}
Copy the contents of the Reach source package over the new project. A handful of files are overwritten, most importantly app.\+c, the .pintool file and the gatt\+\_\+configuration.\+btconf file. Most files are new to the project.\hypertarget{md__getting_01_started_autotoc_md15}{}\doxysubsection{\texorpdfstring{Fill in Dependencies}{Fill in Dependencies}}\label{md__getting_01_started_autotoc_md15}
With the project open in Simplicity Studio, double click on reach\+\_\+tboard.\+slcp file and open the software component manager. For each listed component, enter the name in the search box and install it with any given comments.

Install the following components\+:




\begin{DoxyEnumerate}
\item Iostream\+\_\+retarget\+\_\+stdio
\begin{DoxyEnumerate}
\item Depends on iostream\+\_\+usart\+\_\+core
\end{DoxyEnumerate}
\item CLI Instance
\begin{DoxyEnumerate}
\item Create an instance “inst”
\end{DoxyEnumerate}
\item Iostream\+\_\+usart
\begin{DoxyEnumerate}
\item Create an instance named “vcom”
\item Disable flow control.
\item Convert ~\newline
 to \textbackslash{}r~\newline

\end{DoxyEnumerate}
\item Iostream\+\_\+stdlib\+\_\+config
\item Tiny Printf
\item Simple LED
\begin{DoxyEnumerate}
\item With instance led0 connected GPIO B0
\end{DoxyEnumerate}
\end{DoxyEnumerate}

Add the necessary include paths. Right click on the project in the project explorer and select properties. Open the C/\+C++ build tab and choose settings. Select “\+Includes” for the GNU ARM C Compiler. Add the following\+:




\begin{DoxyEnumerate}
\item \$\{workspace\+\_\+loc\+:/\$\{Proj\+Name\}/\+App\}
\item \$\{workspace\+\_\+loc\+:/\$\{Proj\+Name\}/reach-\/c-\/stack\}
\item \$\{workspace\+\_\+loc\+:/\$\{Proj\+Name\}/reach\+\_\+proto/ansic/built\}
\item \$\{workspace\+\_\+loc\+:/\$\{Proj\+Name\}/reach\+\_\+proto/ansic/nanopb\}
\item \$\{workspace\+\_\+loc\+:/\$\{Proj\+Name\}/reach-\/c-\/stack/\+Io\+T-\/\+Core\}
\item \$\{workspace\+\_\+loc\+:/\$\{Proj\+Name\}/reach-\/c-\/stack/lib\}
\item \$\{workspace\+\_\+loc\+:/\$\{Proj\+Name\}/reach-\/c-\/stack/silabs\}
\end{DoxyEnumerate}

The project should build with this configuration.

You should be able to “\+Debug As” a “\+Silicon Labs ARM Program” by right clicking on the project in the explorer. You may need to set up a debug configuration. You should see the startup banner in your serial console with the new build date.



The Cygnus app should be able to connect to you.

By default the advertised name will contain the last three octets of the system ID. You can use the “sn” command to set a device serial number and then this will be advertised. This demonstrates how each Reach device can have a unique name. ~\newline


You might also note that the first time you run the program it will print red as it initializes the non-\/volatile storage.\hypertarget{md__getting_01_started_autotoc_md16}{}\doxysubsection{\texorpdfstring{Beyond the Demo}{Beyond the Demo}}\label{md__getting_01_started_autotoc_md16}
The source package includes a “\+Programmers Intro” document. It contains a lot more background about the Reach package which should be helpful as you customize it for your own purposes. 